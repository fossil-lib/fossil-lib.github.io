<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fossil WrapDB - Dashboard</title>
    <link rel="stylesheet" href="assets/styles.css"> <!-- Link to the external CSS file -->
</head>
<body>
    <h1>Fossil WrapDB</h1>
    <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="dashboard.html">Dashboard</a></li>
            </ul>
    </nav>
    <label for="searchInput">Search:</label>
    <input type="search" id="searchInput" placeholder="Enter search terms..." oninput="filterList()">

    <table>
        <thead>
            <tr>
                <th>Project</th>
                <th>Description</th>
                <th>Repo URL</th>
                <th>Wrap URL</th>
                <th>License</th>
                <th>Languages</th>
            </tr>
        </thead>
        <tbody id="dashboard"></tbody>
    </table>

    <script>
        // Function to fetch JSON data
        async function fetchData() {
            try {
                const response = await fetch('fscl-project.json');
                const data = await response.json();
                displayProjects(data.projects);
            } catch (error) {
                console.error('Error fetching JSON:', error);
            }
        }

        // Display projects on page load
        fetchData();

        // Function to display projects
        function displayProjects(projects) {
            const dashboardElement = document.getElementById('dashboard');
            dashboardElement.innerHTML = '';

            projects.forEach(project => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${encodeHTML(project.project)}</td>
                    <td>${encodeHTML(project.description)}</td>
                    <td><a href="${encodeHTML(project.url)}" target="_blank">${encodeHTML(project.url)}</a></td>
                    <td><a href="${encodeHTML(project.wrap_url)}" target="_blank">${encodeHTML(project.wrap_url)}</a></td>
                    <td>${encodeHTML(project.license)}</td>
                    <td>${encodeHTML(project.languages.join(', '))}</td>
                `;
                dashboardElement.appendChild(row);
            });
        }

        // Function to encode HTML entities
        function encodeHTML(text) {
            return document.createElement('div').appendChild(document.createTextNode(text)).parentNode.innerHTML;
        }

        // Function to filter the list
        function filterList() {
            const searchInput = document.getElementById('searchInput');
            const filter = searchInput.value.toLowerCase();

            const filteredProjects = projects.filter(project =>
                Object.values(project).some(value =>
                    typeof value === 'string' && value.toLowerCase().includes(filter)
                )
            );

            displayProjects(filteredProjects);
        }
    </script>
</body>
</html>
