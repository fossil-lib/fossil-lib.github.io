<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fossil WrapDB</title>
    <link rel="stylesheet" href="assets/styles.css"> <!-- Link to the external CSS file -->
    <link rel="icon" type="image/png" href="assets/logo.png">
</head>
<body>
    <header>
        <h1>Fossil WrapDB</h1>
        <nav>
            <ul>
                <li><a href="index.html">Home Page</a></li>
                <li><a href="about.html">About Page</a></li>
                <li><a href="wrapdb.html">Fossil WrapDB</a></li>
            </ul>
        </nav>
    </header>

    <label for="searchInput">Search:</label>
    <input type="search" id="searchInput" placeholder="Enter search terms..." oninput="filterList()">

    <div id="tileContainer" class="tile-container"></div>

    <table id="tableView">
        <thead>
            <tr>
                <th>Dependency</th>
                <th>Description</th>
                <th>GitHub URL</th>
                <th>License</th>
                <th>Languages</th>
            </tr>
        </thead>
        <tbody id="dashboard"></tbody>
    </table>

    <script>
        // Function to fetch JSON data
        async function fetchData() {
            try {
                const response = await fetch('fscl-project.json');
                const data = await response.json();
                displayProjects(data.projects);
            } catch (error) {
                console.error('Error fetching JSON:', error);
            }
        }

        // Display projects on page load
        fetchData();

        // Function to display projects
        function displayProjects(projects) {
            const tileContainer = document.getElementById('tileContainer');
            const tableView = document.getElementById('tableView');

            tileContainer.innerHTML = '';
            tableView.innerHTML = '';

            projects.forEach(project => {
                const tile = document.createElement('div');
                tile.className = 'tile';
                tile.innerHTML = `
                    <h3>${encodeHTML(project.project)}</h3>
                    <p>${encodeHTML(project.description)}</p>
                    <p><a href="${encodeHTML(project.url)}" target="_blank">${encodeHTML(project.url)}</a></p>
                    <p>${encodeHTML(project.license)}</p>
                    <p>${encodeHTML(project.languages.join(', '))}</p>
                `;
                tileContainer.appendChild(tile);

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${encodeHTML(project.project)}</td>
                    <td>${encodeHTML(project.description)}</td>
                    <td><a href="${encodeHTML(project.url)}" target="_blank">${encodeHTML(project.url)}</a></td>
                    <td>${encodeHTML(project.license)}</td>
                    <td>${encodeHTML(project.languages.join(', '))}</td>
                `;
                tableView.appendChild(row);
            });
        }

        // Function to encode HTML entities
        function encodeHTML(text) {
            return document.createElement('div').appendChild(document.createTextNode(text)).parentNode.innerHTML;
        }

        // Function to filter the list
        function filterList() {
            const searchInput = document.getElementById('searchInput');
            const filter = searchInput.value.toLowerCase();

            const filteredProjects = projects.filter(project =>
                Object.values(project).some(value =>
                    typeof value === 'string' && value.toLowerCase().includes(filter)
                )
            );

            displayProjects(filteredProjects);
        }

        // Responsive design: switch between tile and table views based on screen width
        window.addEventListener('resize', function() {
            if (window.innerWidth <= 600) {
                document.getElementById('tileContainer').style.display = 'flex';
                document.getElementById('tableView').style.display = 'none';
            } else {
                document.getElementById('tileContainer').style.display = 'none';
                document.getElementById('tableView').style.display = 'table';
            }
        });

        // Trigger the resize event on page load to initialize the view
        window.dispatchEvent(new Event('resize'));
    </script>
</body>
</html>